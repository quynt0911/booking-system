{
  "tables": [
    {
      "name": "users",
      "columns": [
        {
          "name": "id",
          "type": "SERIAL",
          "constraints": {
            "primary_key": true
          }
        },
        {
          "name": "email",
          "type": "VARCHAR(255)",
          "constraints": {
            "unique": true,
            "not_null": true
          }
        },
        {
          "name": "password_hash",
          "type": "TEXT",
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "full_name",
          "type": "VARCHAR(255)"
        },
        {
          "name": "avatar_url",
          "type": "TEXT"
        },
        {
          "name": "phone_number",
          "type": "VARCHAR(20)"
        },
        {
          "name": "gender",
          "type": "VARCHAR(10)"
        },
        {
          "name": "description",
          "type": "TEXT"
        },
        {
          "name": "role",
          "type": "VARCHAR(20)",
          "constraints": {
            "not_null": true,
            "check": ["user", "expert", "admin"]
          }
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "default": "CURRENT_TIMESTAMP"
        }
      ]
    },
    {
      "name": "expert_availability",
      "columns": [
        {
          "name": "id",
          "type": "SERIAL",
          "constraints": {
            "primary_key": true
          }
        },
        {
          "name": "expert_id",
          "type": "INTEGER",
          "constraints": {
            "foreign_key": {
              "table": "users",
              "column": "id",
              "on_delete": "CASCADE"
            }
          }
        },
        {
          "name": "available_date",
          "type": "DATE",
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "start_time",
          "type": "TIME",
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "end_time",
          "type": "TIME",
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "is_off",
          "type": "BOOLEAN",
          "default": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "default": "CURRENT_TIMESTAMP"
        }
      ]
    },
    {
      "name": "expert_off_time",
      "columns": [
        {
          "name": "id",
          "type": "SERIAL",
          "constraints": {
            "primary_key": true
          }
        },
        {
          "name": "expert_id",
          "type": "INTEGER",
          "constraints": {
            "foreign_key": {
              "table": "users",
              "column": "id",
              "on_delete": "CASCADE"
            }
          }
        },
        {
          "name": "off_start",
          "type": "TIMESTAMP",
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "off_end",
          "type": "TIMESTAMP",
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "reason",
          "type": "TEXT"
        }
      ]
    },
    {
      "name": "bookings",
      "columns": [
        {
          "name": "id",
          "type": "SERIAL",
          "constraints": {
            "primary_key": true
          }
        },
        {
          "name": "user_id",
          "type": "INTEGER",
          "constraints": {
            "foreign_key": {
              "table": "users",
              "column": "id",
              "on_delete": "CASCADE"
            }
          }
        },
        {
          "name": "expert_id",
          "type": "INTEGER",
          "constraints": {
            "foreign_key": {
              "table": "users",
              "column": "id",
              "on_delete": "CASCADE"
            }
          }
        },
        {
          "name": "scheduled_time",
          "type": "TIMESTAMP",
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "duration_minutes",
          "type": "INTEGER",
          "default": 30,
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "note",
          "type": "TEXT"
        },
        {
          "name": "mode",
          "type": "VARCHAR(10)",
          "constraints": {
            "not_null": true,
            "check": ["online", "offline"]
          }
        },
        {
          "name": "status",
          "type": "VARCHAR(20)",
          "default": "pending",
          "constraints": {
            "check": ["pending", "confirmed", "rejected", "cancelled", "completed", "missed"]
          }
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "default": "CURRENT_TIMESTAMP"
        }
      ]
    },
    {
      "name": "notifications",
      "columns": [
        {
          "name": "id",
          "type": "SERIAL",
          "constraints": {
            "primary_key": true
          }
        },
        {
          "name": "user_id",
          "type": "INTEGER",
          "constraints": {
            "foreign_key": {
              "table": "users",
              "column": "id",
              "on_delete": "CASCADE"
            }
          }
        },
        {
          "name": "message",
          "type": "TEXT",
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "is_read",
          "type": "BOOLEAN",
          "default": false
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "default": "CURRENT_TIMESTAMP"
        },
        {
          "name": "deleted_at",
          "type": "TIMESTAMP"
        }
      ]
    },
    {
      "name": "feedback",
      "columns": [
        {
          "name": "id",
          "type": "SERIAL",
          "constraints": {
            "primary_key": true
          }
        },
        {
          "name": "booking_id",
          "type": "INTEGER",
          "constraints": {
            "foreign_key": {
              "table": "bookings",
              "column": "id",
              "on_delete": "CASCADE"
            }
          }
        },
        {
          "name": "user_id",
          "type": "INTEGER",
          "constraints": {
            "foreign_key": {
              "table": "users",
              "column": "id",
              "on_delete": "CASCADE"
            }
          }
        },
        {
          "name": "rating",
          "type": "INTEGER",
          "constraints": {
            "check": "rating BETWEEN 1 AND 5"
          }
        },
        {
          "name": "comment",
          "type": "TEXT"
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "default": "CURRENT_TIMESTAMP"
        }
      ]
    },
    {
      "name": "refresh_tokens",
      "columns": [
        {
          "name": "id",
          "type": "SERIAL",
          "constraints": {
            "primary_key": true
          }
        },
        {
          "name": "user_id",
          "type": "INTEGER",
          "constraints": {
            "foreign_key": {
              "table": "users",
              "column": "id",
              "on_delete": "CASCADE"
            }
          }
        },
        {
          "name": "token",
          "type": "TEXT",
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "expires_at",
          "type": "TIMESTAMP",
          "constraints": {
            "not_null": true
          }
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "default": "CURRENT_TIMESTAMP"
        }
      ]
    },
    {
      "name": "job_logs",
      "columns": [
        {
          "name": "id",
          "type": "SERIAL",
          "constraints": {
            "primary_key": true
          }
        },
        {
          "name": "job_type",
          "type": "VARCHAR(50)"
        },
        {
          "name": "status",
          "type": "VARCHAR(20)",
          "constraints": {
            "check": ["success", "failed"]
          }
        },
        {
          "name": "error_message",
          "type": "TEXT"
        },
        {
          "name": "executed_at",
          "type": "TIMESTAMP",
          "default": "CURRENT_TIMESTAMP"
        }
      ]
    },
    {
      "name": "booking_stats",
      "columns": [
        {
          "name": "id",
          "type": "SERIAL",
          "constraints": {
            "primary_key": true
          }
        },
        {
          "name": "expert_id",
          "type": "INTEGER",
          "constraints": {
            "foreign_key": {
              "table": "users",
              "column": "id"
            }
          }
        },
        {
          "name": "week_start",
          "type": "DATE"
        },
        {
          "name": "total_bookings",
          "type": "INTEGER"
        },
        {
          "name": "completed_count",
          "type": "INTEGER"
        },
        {
          "name": "cancelled_count",
          "type": "INTEGER"
        },
        {
          "name": "generated_at",
          "type": "TIMESTAMP",
          "default": "CURRENT_TIMESTAMP"
        }
      ]
    }
  ]
}